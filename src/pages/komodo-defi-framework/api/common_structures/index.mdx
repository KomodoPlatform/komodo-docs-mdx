export const title = "Komodo DeFi SDK RPC Protocol v2.0";
export const description = "Starting with version beta-2.1.3434, the Komodo DeFi SDK supports the standardized protocol format called mmrpc 2.0.";

# Komodo DeFi SDK Common Structures

The objects are in the request or response of multiple Komodo DeFi SDK methods have been grouped into the following sections:

<TocForIndex />

Structures which are used in more than one section are listed below:

## Common Enums

### SwapMethodEnum

Used in [trade\_preimage](/komodo-defi-framework/api/legacy/trade_preimage/) method to specify the swap operation type:

| Value      | Description                                                  |
| ---------- | ------------------------------------------------------------ |
| `buy`      | Create a buy order (taker wants to receive the base coin)    |
| `sell`     | Create a sell order (taker wants to sell the base coin)      |
| `setprice` | Create a maker order (provide liquidity at a specific price) |

### ActionEnum

Used in [best\_orders](/komodo-defi-framework/api/legacy/best_orders/) and other trading methods:

| Value  | Description                            |
| ------ | -------------------------------------- |
| `buy`  | Find orders to buy the specified coin  |
| `sell` | Find orders to sell the specified coin |

### OrderTypeEnum

Used in [orders\_history\_by\_filter](/komodo-defi-framework/api/legacy/orders_history_by_filter/) to filter by order role:

| Value   | Description                                      |
| ------- | ------------------------------------------------ |
| `Maker` | Orders that provide liquidity to the orderbook   |
| `Taker` | Orders that consume liquidity from the orderbook |

### OrderStatusEnum

Used in [orders\_history\_by\_filter](/komodo-defi-framework/api/legacy/orders_history_by_filter/) to filter by order status:

**Active Order Statuses:**

| Value     | Order Type  | Description                  |
| --------- | ----------- | ---------------------------- |
| `Created` | Maker/Taker | Order has been created       |
| `Updated` | Maker       | Maker order has been updated |

**Inactive Order Statuses:**

| Value                  | Order Type  | Description                          |
| ---------------------- | ----------- | ------------------------------------ |
| `Fulfilled`            | Maker/Taker | Order has been completely filled     |
| `Insufficient Balance` | Maker       | Insufficient funds to complete order |
| `Cancelled`            | Maker/Taker | Order has been manually cancelled    |
| `Timed Out`            | Taker       | Taker order expired before matching  |

### UnbanTypeEnum

Used in [unban\_pubkeys](/komodo-defi-framework/api/legacy/unban_pubkeys/) method:

| Value | Description                        |
| ----- | ---------------------------------- |
| `All` | Unban all currently banned pubkeys |
| `Few` | Unban specific pubkeys from a list |

### BanTypeEnum

Used in [list\_banned\_pubkeys](/komodo-defi-framework/api/legacy/list_banned_pubkeys/) response to indicate the type of ban:

| Value        | Description                                                   |
| ------------ | ------------------------------------------------------------- |
| `Manual`     | Pubkey was manually banned by the user                        |
| `FailedSwap` | Pubkey was automatically banned due to a failed swap protocol |

### MetricTypeEnum

Used in [metrics](/komodo-defi-framework/api/legacy/metrics/) response to indicate the type of metric measurement:

| Value       | Description                                                                   |
| ----------- | ----------------------------------------------------------------------------- |
| `counter`   | A monotonically increasing metric that tracks cumulative events or quantities |
| `gauge`     | A metric that represents a single numerical value that can go up or down      |
| `histogram` | A metric that samples observations and counts them in configurable buckets    |

### CancelByTypeEnum

Used in [cancel\_all\_orders](/komodo-defi-framework/api/legacy/cancel_all_orders/) method to specify which orders to cancel:

| Value  | Description                                                  |
| ------ | ------------------------------------------------------------ |
| `All`  | Cancel all active orders created by the node                 |
| `Pair` | Cancel all orders for a specific trading pair (base/rel)     |
| `Coin` | Cancel all orders involving a specific coin (as base or rel) |

### ChannelStatusEnum

Used in Lightning Network [get\_channel\_details](/komodo-defi-framework/api/v20/lightning/channels/#get-channel-details) response to indicate channel status:

| Value     | Description                                                    |
| --------- | -------------------------------------------------------------- |
| `Open`    | Channel is currently open and available for transactions       |
| `Closed`  | Channel has been closed (either cooperatively or force-closed) |
| `Pending` | Channel is in the process of opening or closing                |

### ChannelTypeEnum

Used in Lightning Network channel filter methods for [list\_open\_channels\_by\_filter](/komodo-defi-framework/api/v20/lightning/channels/#list-open-channels-by-filter) and [list\_closed\_channels\_by\_filter](/komodo-defi-framework/api/v20/lightning/channels/#list-closed-channels-by-filter):

| Value      | Description                                                    |
| ---------- | -------------------------------------------------------------- |
| `Inbound`  | Channel where the counterparty opened the channel to your node |
| `Outbound` | Channel where your node opened the channel to the counterparty |

### EstimatorTypeEnum

Used in [get\_eth\_estimated\_fee\_per\_gas](/komodo-defi-framework/api/v20/wallet/fee_management/get_eth_estimated_fee_per_gas/#get-eth-estimated-fee-per-gas) to specify gas estimation strategies:

| Value          | Description                                                               |
| -------------- | ------------------------------------------------------------------------- |
| `Conservative` | Use conservative gas estimation for slower but more reliable confirmation |
| `Standard`     | Use standard gas estimation for normal transaction speed                  |
| `Fast`         | Use fast gas estimation for quicker transaction confirmation              |
| `Fastest`      | Use fastest gas estimation for immediate transaction processing           |

## TokenProtocol

Standard object structure used in token information methods like [get\_token\_info](/komodo-defi-framework/api/v20/utils/get_token_info/#get-token-info).

| Parameter      | Type   | Required | Description                                                 |
| -------------- | ------ | :------: | ----------------------------------------------------------- |
| type           | string |     ✓    | Token type - e.g `ERC20` for tokens on the Ethereum network |
| protocol\_data | object |     ✓    | Protocol-specific data object                               |

### TokenProtocolData

Sub-object of [TokenProtocol](/komodo-defi-framework/api/common_structures/#token-protocol) containing platform-specific token information.

| Parameter         | Type   | Required | Description                                                                                                                                                                                                        |
| ----------------- | ------ | :------: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| platform          | string |     ✓    | The parent coin of the token's platform - e.g `MATIC` for PLG20 tokens                                                                                                                                             |
| contract\_address | string |     ✓    | **Must be mixed case** The identifying hex string for the token's contract. Can be found on sites like [EthScan](https://etherscan.io/), [BscScan](https://bscscan.com/) & [PolygonScan](https://polygonscan.com/) |

## TokenActivationParams

Standard object structure used in token activation methods for specifying activation parameters.

| Parameter               | Type    | Required | Default | Description                                                                          |
| ----------------------- | ------- | :------: | :-----: | ------------------------------------------------------------------------------------ |
| required\_confirmations | integer |     ✗    |   `-`   | Confirmations to wait for steps in swap. Defaults to value in coins file if not set. |

### NumericFormatsValue

The `NumericFormatsValue` returns a price or amount in three different formats: `fraction`, `rational`, and `decimal`.

| Parameter | Type           | Required | Description                                                                                          |
| --------- | -------------- | :------: | ---------------------------------------------------------------------------------------------------- |
| decimal   | numeric string |     ✓    | A decimal number as a string.                                                                        |
| rational  | object         |     ✓    | A standard [RationalValue](/komodo-defi-framework/api/common_structures/#rational-value) object.     |
| fraction  | object         |     ✓    | A standard [FractionalValue](/komodo-defi-framework/api/common_structures/#fractional-value) object. |

<CollapsibleSection expandedText="Hide Example" collapsedText="Show Example">
  ```json
  {
    "decimal": "0.0001",
    "rational": [
      [1, [1]],
      [1, [10000]]
    ],
    "fraction": {
      "numer": "1",
      "denom": "10000"
    }
  }
  ```
</CollapsibleSection>

### FractionalValue

The `FractionalValue` object includes a [numerator and denominator](https://www.freemathhelp.com/numerator-denominator/) values for a given price or amount:

| Parameter | Type             | Required | Description                              |
| --------- | ---------------- | :------: | ---------------------------------------- |
| numer     | string (numeric) |     ✓    | The numerator of the fractional value.   |
| denom     | string (numeric) |     ✓    | The denominator of the fractional value. |

<CollapsibleSection expandedText="Hide Example" collapsedText="Show Example">
  ```json
  {
      "numer": "4561782244811",
      "denom": "4000000"
  }
  ```
</CollapsibleSection>

### Pagination

For requests which return many results, pagination offsets may be applied. \*\* Use either value, not both. \*\*

| Parameter  | Type    | Required | Default | Description                            |
| ---------- | ------- | :------: | :-----: | -------------------------------------- |
| PageNumber | integer |     ✗    |   `1`   | Offset for paginated results           |
| FromId     | integer |     ✗    |   `-`   | Ignores any results prior to this UUID |

<CollapsibleSection expandedText="Hide Example" collapsedText="Show Example">
  #### Example

  ```json
  {
      "PageNumber": 1
  }
  ```

  ```json
  {
      "FromId": 4
  }
  ```
</CollapsibleSection>

### RationalValue

The Komodo DeFi SDK now offers the [num-rational crate](https://crates.io/crates/num-rational) feature which allows for higher precision numeric values to represent order volumes and prices in a unique format as explained below:

```json
[
  [1, [0, 1]],
  [1, [1]]
]
```

In the above unique format, the first item `[1,[0,1]]` is the `numerator` and the second item `[1,[1]]` is the `denominator`.

The `numerator` and `denominator` are BigInteger numbers represented as a sign and a uint32 array (where numbers are 32-bit parts of big integer in little-endian order).

`[1,[0,1]]` represents `+0000000000000000000000000000000010000000000000000000000000000000` = `4294967296`

`[-1,[1,1]]` represents `-1000000000000000000000000000000010000000000000000000000000000000` = `-4294967297`

### StreamingConfig

You can optionally apply more detailed configuration to event streaming methods.

| Parameter                 | Type    | Required |  Default | Description                                                                                                                                                                                                                                                                                                                                                   |
| ------------------------- | ------- | :------: | :------: | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| stream\_interval\_seconds | float   |     ✗    | `10`/`5` | Interval in seconds between streaming event update requests. Defaults to `10` for [stream::balance::enable](/komodo-defi-framework/api/v20/streaming/balance_enable/) and `5` for [stream::network::enable](/komodo-defi-framework/api/v20/streaming/network_enable/)/[stream::heartbeat::enable](/komodo-defi-framework/api/v20/streaming/heartbeat_enable/) |
| always\_send              | boolean |     ✗    |  `false` | [stream::network::enable](/komodo-defi-framework/api/v20/streaming/network_enable/) only. If `true`, network data will always be sent every `stream_interval_seconds`, even when there is no change. If `false`, network data will be sent regardless.                                                                                                        |

<CollapsibleSection expandedText="Hide Examples" collapsedText="Show Examples">
  #### Example

  ```json
  {
      "stream_interval_seconds": 33.3
  }
  ```

  ### StreamingFeeConfig

  | Parameter       | Type   | Required |  Default | Description                                                                                                                                                                                                                                                                                                                                                                                   |
  | --------------- | ------ | :------: | :------: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
  | estimate\_every | float  |     ✗    |   `15`   | Interval in seconds between fee estimate updates.                                                                                                                                                                                                                                                                                                                                             |
  | estimate\_type  | string |     ✗    | `Simple` | If set to `Provider`, users must set the `gas_api` setting in their [MM2.json file](/komodo-defi-framework/setup/configure-mm2-json/) to source recommended fee values from third party providers [Infura](https://www.infura.io/) or [Blocknative](https://www.blocknative.com/) Used in [get\_eth\_estimated\_fee\_per\_gas](/komodo-defi-framework/api/v20/streaming/fee_estimator/) only. |

  #### Example (stream::fee\_estimator::enable)

  ```json
  {
      "estimate_every": 33.3,
      "estimate_type": "Provider"
  }
  ```
</CollapsibleSection>

### EventStreamConfig

The `EventStreamConfig` object defines which events will be streamed to the client:

| Parameter                      | Type   | Required | Default | Description                                                |
| ------------------------------ | ------ | :------: | :-----: | ---------------------------------------------------------- |
| access\_control\_allow\_origin | string |     ✗    |   `-`   | Defines CORS whitelist. Use "\*" to allow from any origin. |
| worker\_path                   | string |     ✗    |   `-`   | WASM only. Path to a custom `worker.js` file.              |

Configurable events, and how to enable them, is detailed in the [streaming methods doc](/komodo-defi-framework/api/v20/streaming/)

An example of the event stream output can then be viewed in [https://github.com/KomodoPlatform/komodo-defi-framework/blob/main/examples/sse/index.html?id=CLIENT\_ID](https://github.com/KomodoPlatform/komodo-defi-framework/blob/main/examples/sse/index.html?id=0)

The `CLIENT_ID` value used in the url must match the `client_id` value used when enabling streaming events. In the case of a single client only, defining the client\_id is not required (it will default to `0`).

<CollapsibleSection expandedText="Hide Example" collapsedText="Show Example">
  ```json
  {
      "access_control_allow_origin": "*",
      "worker_path": "index.js"
  }
  ```
</CollapsibleSection>

### SyncStatus

| Parameter        | Type   | Required | Description                                                                                                                                                                                                     |
| ---------------- | ------ | :------: | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| state            | string |     ✓    | current state of sync; possible values: `NotEnabled`, `NotStarted`, `InProgress`, `Error`, `Finished`                                                                                                           |
| additional\_info | object |     ✓    | A standard [SyncStatusExtended](/komodo-defi-framework/api/common_structures/#sync-status-extended) object. Additional info that helps to track the progress; present for `InProgress` and `Error` states only. |

### SyncStatusExtended

| Parameter          | Type   | Required | Description                                                                                                  |
| ------------------ | ------ | :------: | ------------------------------------------------------------------------------------------------------------ |
| blocks\_left       | number |     ✗    | present for ETH/ERC20 coins only; displays the number of blocks left to be processed for `InProgress` state  |
| transactions\_left | number |     ✗    | present for UTXO coins only; displays the number of transactions left to be processed for `InProgress` state |
| code               | number |     ✗    | displays the error code for `Error` state                                                                    |
| message            | number |     ✗    | displays the error message for `Error` state                                                                 |

<CollapsibleSection expandedText="Hide Example" collapsedText="Show Example">
  #### Example

  ```json
  {
      "sync_status": {
        "state": "NotStarted"
      }
  }
  ```

  ```json
  {
      "sync_status": {
        "additional_info": {
          "transactions_left": 126
        },
        "state": "InProgress"
      }
  }
  ```

  ```json
  {
      "sync_status": {
        "state": "Finished"
      }
  }
  ```
</CollapsibleSection>

### FilterCriteria

The 'FilterCriteria' object allows you to filter the results based on specific parameters.

| Parameter       | Type   | Required | Default | Description                                    |
| --------------- | ------ | :------: | :-----: | ---------------------------------------------- |
| status          | string |     ✗    |   `-`   | Status of the transactions (e.g., "completed") |
| date\_from      | string |     ✗    |   `-`   | Start date in ISO 8601 format                  |
| date\_to        | string |     ✗    |   `-`   | End date in ISO 8601 format                    |
| my\_coin        | string |     ✗    |   `-`   | Coin being used by you for the swap/trade.     |
| other\_coin     | string |     ✗    |   `-`   | Coin you are trading against                   |
| from\_timestamp | number |     ✗    |   `-`   | Start timestamp in UNIX format                 |
| to\_timestamp   | number |     ✗    |   `-`   | End timestamp in UNIX format                   |

<CollapsibleSection expandedText="Hide Example" collapsedText="Show Example">
  #### Example

  ```json
  {
    "filter": {
      "status": "completed",
      "date_from": "2024-01-01T00:00:00Z",
      "date_to": "2024-07-01T00:00:00Z",
      "my_coin": "BTC",
      "other_coin": "ETH",
      "from_timestamp": 1672531200,
      "to_timestamp": 1704067200
    }
  }
  ```
</CollapsibleSection>

### PagingOptions

The `PagingOptions` object includes options of page selection to consult when looking for recent swaps:

| Parameter    | Type             | Required | Default | Description                                                                                                            |
| ------------ | ---------------- | :------: | :-----: | ---------------------------------------------------------------------------------------------------------------------- |
| from\_uuid   | string (or null) |     ✗    |  `null` | Skips records until this UUID, excluding the record with this UUID. Convenient for infinite scrolling implementations. |
| limit        | number           |     ✗    |   `-`   | Limits the number of returned swaps.                                                                                   |
| page\_number | number           |     ✗    |   `-`   | Returns limit swaps from the selected page. This parameter is ignored if from\_uuid is set.                            |

<CollapsibleSection expandedText="Hide Examples" collapsedText="Show Examples">
  #### Example

  ```json
  {
    "paging_options": {
      "from_uuid": null,
      "limit": 10,
      "page_number": 1
    }
  }
  ```
</CollapsibleSection>

## Standard Error types

#### NoSuchCoin

The specified coin was not found or is not activated yet.

| Parameter | Type   | Required | Description                                   |
| --------- | ------ | :------: | --------------------------------------------- |
| coin      | string |     ✓    | the not found `coin` specified in the Request |

#### Transport

The request was failed due to a network error.

| Parameter | Type   | Required | Description                     |
| --------- | ------ | :------: | ------------------------------- |
| (none)    | string |     ✓    | the transport error description |

#### InternalError

The request was failed due to an Komodo DeFi API internal error.

| Parameter | Type   | Required | Description                    |
| --------- | ------ | :------: | ------------------------------ |
| (none)    | string |     ✓    | the internal error description |
