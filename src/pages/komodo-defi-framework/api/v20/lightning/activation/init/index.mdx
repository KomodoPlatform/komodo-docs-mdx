export const title = "Komodo DeFi Framework Method: Initialize Lightning Activation Task";
export const description = "Request a task to initialize a lightning node on the Komodo DeFi Framework.";

# Initialize Lightning Activation Task

## task::enable\_lightning::init {{label : 'task::enable_lightning::init', tag : 'API-v2'}}

The `task::enable_lightning::init` method requests a task to run a Lightning node. Use the returned `task_id` as an input to check the status of the Lightning node (i.e., running or still initiating). An error will be returned if a Lightning node was already running for the requested ticker.

<Note>
  Any methods with a `task::` prefix will be linked to a numeric `task_id` value, which is used to query the status or outcome of the task.
</Note>

### Request Parameters

| Parameter          | Type   | Required | Description                                                                                                                         |
| ------------------ | ------ | :------: | ----------------------------------------------------------------------------------------------------------------------------------- |
| activation\_params | object |     ‚úì    | A standard [LightningActivationParams](/komodo-defi-framework/api/common_structures/lightning/#lightning-activation-params) object. |
| ticker             | string |     ‚úì    | Ticker of coin to activate.                                                                                                         |

### Response Parameters

| Parameter | Type    | Description                                               |
| --------- | ------- | --------------------------------------------------------- |
| task\_id  | integer | An identifying number which is used to query task status. |

#### üìå Example

<CodeGroup title="task::enable_lightning::init" tag="POST" label="task::enable_lightning::init" mm2MethodDecorate="true">
  ```json
  {
    "method": "task::enable_lightning::init",
    "userpass": "RPC_UserP@SSW0RD",
    "mmrpc": "2.0",
    "params": {
      "ticker": "tBTC-lightning",
      "activation_params": {
        "name": "KomoDeFi-Docs-Node-1",
        "listening_port": 9735,
        "color": "000000",
        "payment_retries": 5
      }
    },
    "id": 2
  }
  ```
</CodeGroup>

<CollapsibleSection expandedText="Hide Response" collapsedText="Show Response">
  #### Response

  ```json
  {
      "mmrpc": "2.0",
      "result": {
          "task_id": 1
      },
      "id": null
  }
  ```
</CollapsibleSection>

<CollapsibleSection expandedText="Hide Error Responses" collapsedText="Show Error Responses">
  ### ‚ö†Ô∏è Error Responses

  ##### L2ConfigIsNotFound Error

  Coin is not in `coins` file. Refer to the [coins file configuration for lightning](/komodo-defi-framework/api/v20/lightning/#coin-config-parameters) for more information.

  ```json
  {
      "mmrpc": "2.0",
      "error": "Layer 2 tBTC-lightning config is not found",
      "error_path": "init_l2.prelude",
      "error_trace": "init_l2:82] prelude:82]",
      "error_type": "L2ConfigIsNotFound",
      "error_data": "tBTC-lightning",
      "id": 2
  }
  ```

  ##### InvalidRequest Error

  A parameter is incorrect.

  ```json
  {
      "mmrpc": "2.0",
      "error": "Error parsing request: invalid type: string '9735', expected u16",
      "error_path": "dispatcher",
      "error_trace": "dispatcher:110]",
      "error_type": "InvalidRequest",
      "error_data": "invalid type: string '9735', expected u16",
      "id": 762
  }
  ```

  ##### UnexpectedL2Protocol Error

  Coin is wrong protocol type.

  ```json
  {
      "mmrpc": "2.0",
      "error": "Unexpected layer 2 protocol UTXO for tBTC-segwit",
      "error_path": "init_l2.prelude.lightning_activation",
      "error_trace": "init_l2:82] prelude:93] lightning_activation:92]",
      "error_type": "UnexpectedL2Protocol",
      "error_data": {
          "ticker": "tBTC-segwit",
          "protocol": {
              "type": "UTXO"
          }
      },
      "id": 2
  }
  ```

  ##### Internal Error

  Address already in use.

  ```json
  {
      "mmrpc": "2.0",
      "result": {
          "status": "Error",
          "details": {
              "error": "I/O error Address already in use (os error 48)",
              "error_path": "lib.lightning_activation.ln_p2p",
              "error_trace": "lib:103] lightning_activation:280] ln_p2p:196]",
              "error_type": "Internal",
              "error_data": "I/O error Address already in use (os error 48)"
          }
      },
      "id": null
  }
  ```

  ##### PlatformCoinIsNotActivated Error

  The selected coin is not activated. It needs to be activated before the lightning node can be initialized.

  ```json
  {
      "mmrpc": "2.0",
      "error": "Platform coin tBTC-lightning is not activated",
      "error_path": "init_l2.lp_coins",
      "error_trace": "init_l2:87] lp_coins:3087]",
      "error_type": "PlatformCoinIsNotActivated",
      "error_data": "tBTC-lightning",
      "id": 2
  }
  ```

  ##### InvalidPlatformConfiguration Error

  Coin's configuration is missing a required parameter. Refer to the [coins file configuration for lightning](/komodo-defi-framework/api/v20/lightning/#coin-configuration) for more information.

  ```json
  {
      "mmrpc": "2.0",
      "error": "Invalid config for platform coin: tBTC-segwit, error: 'avg_blocktime' field is not found in platform coin config",
      "error_path": "init_l2.lightning_activation",
      "error_trace": "init_l2:95] lightning_activation:254]",
      "error_type": "InvalidPlatformConfiguration",
      "error_data": {
          "platform_coin_ticker": "tBTC-segwit",
          "err": "'avg_blocktime' field is not found in platform coin config"
      },
      "id": 2
  }
  ```
</CollapsibleSection>
