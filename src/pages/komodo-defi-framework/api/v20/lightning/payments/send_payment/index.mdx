export const title = "Send Payment";
export const description = "Send a Lightning Network payment using the Komodo DeFi Framework.";

# Send Payment

## Send Payment {{label : 'lightning::payments::send_payment', tag : 'API-v2'}}

The `lightning::payments::send_payment` method sends a payment to another node. Used to pay an invoice or send a payment via pubkey/address.

### Request Arguments

| Parameter | Type   | Required | Default | Description                                                                                                      |
| --------- | ------ | :------: | :-----: | ---------------------------------------------------------------------------------------------------------------- |
| coin      | string |     ‚úì    |   `-`   | Ticker of the coin to query.                                                                                     |
| payment   | object |     ‚úì    |   `-`   | A standard [LightningPayment](/komodo-defi-framework/api/common_structures/lightning/#lightning-payment) object. |

#### üìå Example using `invoice`

<CodeGroup title="Send Payment" tag="POST" label="lightning::payments::send_payment" mm2MethodDecorate="true">
  ```json
  {
    "userpass": "RPC_UserP@SSW0RD",
    "mmrpc": "2.0",
    "method": "lightning::payments::send_payment",
    "params": {
      "coin": "tBTC-lightning",
      "payment": {
        "type": "invoice",
        "invoice": "lntb20u1p32wwxapp5p8gjy2e79jku5tshhq2nkdauv0malqqhzefnqmx9pjwa8h83cmwqdp8xys9xcmpd3sjqsmgd9czq3njv9c8qatrvd5kumcxqrrsscqp79qy9qsqsp5m473qknpecv6ajmwwtjw7keggrwxerymehx6723avhdrlnxmuvhs54zmyrumkasvjp0fvvk2np30cx5xpjs329alvm60rwy3payrnkmsd3n8ahnky3kuxaraa3u4k453yf3age7cszdxhjxjkennpt75erqpsfmy4y"
      }
    },
    "id": 6
  }
  ```
</CodeGroup>

<CollapsibleSection expandedText="Hide Response" collapsedText="Show Response">
  #### Response

  ```json
  {
   "mmrpc": "2.0",
   "result": {
    "payment_hash": "c4e25cc10d77e3cd5f3d2af7b14ad72f123b2a5021bd6705c0b8ee8386bdeceb"
   },
   "id": 762
  }
  ```
</CollapsibleSection>

#### üìå Example using `keysend`

<CodeGroup title="Send Payment" tag="POST" label="lightning::payments::send_payment" mm2MethodDecorate="true">
  ```json
  {
    "userpass": "RPC_UserP@SSW0RD",
    "mmrpc": "2.0",
    "method": "lightning::payments::send_payment",
    "params": {
      "coin": "tBTC-lightning",
      "payment": {
        "type": "keysend",
        "destination": "038863cf8ab91046230f561cd5b386cbff8309fa02e3f0c3ed161a3aeb64a643b9",
        "amount_in_msat": 1000,
        "expiry": 24
      }
    },
    "id": 6
  }
  ```
</CodeGroup>

<CollapsibleSection expandedText="Hide Response" collapsedText="Show Response">
  #### Response

  ```json
  {
   "mmrpc": "2.0",
   "result": {
    "payment_hash": "2620d47033fd366bff40cfe0879c47f683ef66c3882d0fab88a9bc72b5499655"
   },
   "id": 762
  }
  ```
</CollapsibleSection>

<CollapsibleSection expandedText="Hide Error Responses" collapsedText="Show Error Responses">
  ### ‚ö†Ô∏è Error Responses

  ##### PaymentError (attempt to pay self)

  ```json
  {
   "mmrpc": "2.0",
   "error": "Payment error: Error paying invoice: Routing(LightningError { err: 'Cannot generate a route to ourselves', action: IgnoreError })",
   "error_path": "send_payment.lightning",
   "error_trace": "send_payment:102] lightning:231]",
   "error_type": "PaymentError",
   "error_data": "Error paying invoice: Routing(LightningError { err: 'Cannot generate a route to ourselves', action: IgnoreError })",
   "id": 6
  }
  ```

  ##### PaymentError (no outbound routes)

  ```json
  {
   "mmrpc": "2.0",
   "error": "Payment error: Error paying invoice: Routing(LightningError { err: 'Cannot route when there are no outbound routes away from us ', action: IgnoreError })",
   "error_path": "send_payment.lightning",
   "error_trace": "send_payment:102] lightning:232]",
   "error_type": "PaymentError",
   "error_data": "Error paying invoice: Routing(LightningError { err: 'Cannot route when there are no outbound routes away from us ', action: IgnoreError })",
   "id": 762
  }
  ```

  ##### PaymentError (keysend - no path to destination)

  ```json
  {
   "mmrpc": "2.0",
   "error": "Payment error: Keysend error: Routing(LightningError { err: 'Failed to find a path to the given destination', action: IgnoreError })",
   "error_path": "send_payment.lightning",
   "error_trace": "send_payment:107] lightning:256]",
   "error_type": "PaymentError",
   "error_data": "Keysend error: Routing(LightningError { err: 'Failed to find a path to the given destination', action: IgnoreError })",
   "id": 762
  }
  ```

  ##### PaymentError (invoice - no path to destination)

  ```json
  {
   "mmrpc": "2.0",
   "error": "Payment error: Error paying invoice: Routing(LightningError { err: 'Failed to find a path to the given destination', action: IgnoreError })",
   "error_path": "send_payment.lightning",
   "error_trace": "send_payment:102] lightning:232]",
   "error_type": "PaymentError",
   "error_data": "Error paying invoice: Routing(LightningError { err: 'Failed to find a path to the given destination', action: IgnoreError })",
   "id": 762
  }
  ```

  ##### InvalidRequest (request is missing a required field)

  ```json
  {
   "mmrpc": "2.0",
   "error": "Error parsing request: missing field `payment`",
   "error_path": "dispatcher",
   "error_trace": "dispatcher:109]",
   "error_type": "InvalidRequest",
   "error_data": "missing field `payment`",
   "id": 762
  }
  ```

  ##### InvalidRequest (a required field is invalid)

  ```json
  {
   "mmrpc": "2.0",
   "error": "Error parsing request: ParseError(Bech32Error(MissingSeparator))",
   "error_path": "dispatcher",
   "error_trace": "dispatcher:109]",
   "error_type": "InvalidRequest",
   "error_data": "ParseError(Bech32Error(MissingSeparator))",
   "id": 762
  }
  ```
</CollapsibleSection> 